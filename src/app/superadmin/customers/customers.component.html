<div class="container-fluid table-details">
    <div class='search-One'><br>
      <input class="searchOne search" type="text" name='search' id="search1" [(ngModel)]="searchdashboard"
        placeholder="Search" autocomplete="off" />
    </div>
    <table class="table table-striped col-md-12" border="2" aria-describedby="mydesc">
      <thead>
        <tr>
          <th scope="col" sortable="area" class="tablecolumn-style">Admin Name <i (click)="onSortClick($event)"
              class="my-icon fa fa-chevron-up"></i></th>
          <th scope="col" sortable="population" class="tablecolumn-style">Subscribed Plan
            <i (click)="onSortClick($event)" class="my-icon fa fa-chevron-up"></i>
          </th>
          <th scope="col" sortable="population" class="tablecolumn-style">Latest Invoice
            Amount <i (click)="onSortClick($event)" class="my-icon fa fa-chevron-up"></i></th>
          <th scope="col" sortable="population" class="tablecolumn-style">Last Billing Date
            <i (click)="onSortClick($event)" class="my-icon fa fa-chevron-up"></i>
          </th>
          <th scope="col" sortable="population" class="tablecolumn-style">Next Billing Date
            <i (click)="onSortClick($event)" class="my-icon fa fa-chevron-up"></i>
          </th>
          <th scope="col" sortable="population" class="tablecolumn-style">Mobile<i (click)="onSortClick($event)"
              class="my-icon fa fa-chevron-up"></i></th>
          <th scope="col" sortable="population" class="tablecolumn-style">Email<i (click)="onSortClick($event)"
              class="my-icon fa fa-chevron-up"></i></th>
          <th scope="col" sortable="population" class="tablecolumn-style">Action</th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="let plan of plans | paginate: { itemsPerPage: 10, currentPage: p } | FilterPipe: searchdashboard">
          <td>{{plan.tenantAdminName}}</td>
          <td>{{plan.subscribedPlan}}</td>
          <td>{{plan.lastInvoiceAmount|currency}}</td>
          <td>{{plan.lastBillingDate}}</td>
          <td>{{plan.dueDate}}</td>
          <td>{{plan.mobile}}</td>
          <td>{{plan.email}}</td>
          <td>
            <button (click)="openEditOverlay(plan)">
              <img src="../../../../assets/images/editCard.svg" alt="edit" />
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    <div *ngIf="plans!=='undefined'" class="dashboardpagination">
      <pagination-controls (pageChange)="p = $event"></pagination-controls>
    </div>
  </div>

  <div id="subscrip-edit">
    <div class="row slider_heading">
      <h4>Edit</h4>
      <span class="cros">
        <span (click)="slideLeft()"><img class="" src="assets/images/crossclose.svg" alt="crossclose"></span>
      </span>
    </div>
    <div class="content">
      <div class="form_content">
        <form class="" [formGroup]="subscriptionForm">
          <div class="col-md-12 m-0 p-0">
            <div class="form-group col-md-12 p-0">
              <label class="label-control"> Subscription Plan<span class="star">*</span>
              </label>
              <select name="" id="" class="form-control data" formControlName="subscriptionplan"
                (change)="onChange($event.target.value)">
                <option value="default" [selected]="true" hidden disabled>Select Plan</option>
                <option value="standard">Standard</option>
                <option value="professional">Professional</option>
                <option value="enterprise">Enterprise</option>
                <option value="custom">Custom</option>
              </select>
              <span
                *ngIf="subscriptionForm.get('subscriptionplan').invalid && subscriptionForm.get('subscriptionplan').touched"
                class="errspan required"> Subscription Plan Required* </span>
            </div>
            <div *ngIf="isCustom">
              <div class="form-group col-md-12 p-0">
                <label class="label-control"> Interval <span class="star">*</span>
                </label>
                <select name="" id="" class="form-control data" formControlName="interval">
                  <option value="default" [selected]="true" hidden disabled> Select Interval</option>
                  <option value="week">Week</option>
                  <option value="month">Month</option>
                  <option value="year">Year</option>
                </select>
                <span *ngIf="subscriptionForm.get('interval').invalid && subscriptionForm.get('interval').touched"
                  class="errspan required"> Interval is Required* </span>
              </div>
              <div class="form-group col-md-12 p-0 checkboxes">
                <label class="label-control">Plan Features</label>
                <div class="row">
                  <div class="col-md-6 pr-0 form-group">
                    <input type="checkbox" formControlName="artificial_intelligence">
                    <label class="label-control">
                      <span class="checkboxlabel">Artificial Intelligence</span>
                    </label>
                  </div>
                  <div class="col-md-6 pr-0 form-group">
                    <input type="checkbox" formControlName="business_process_studio">
                    <label class="label-control">
                      <span class="checkboxlabel">Business Process Studio</span>
                    </label>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6 pr-0 form-group">
                    <input type="checkbox" formControlName="process_intelligence">
                    <label class="label-control">
                      <span class="checkboxlabel">Process Intelligence</span>
                    </label>
                  </div>
                  <div class="col-md-6 pr-0">
                    <input type="checkbox" formControlName="live_support">
                    <label class="label-control">
                      <span class="checkboxlabel">Live Support</span>
                    </label>
                  </div>
                </div>  
                  <div class="col-md-12 pl-0">
                    <input type="checkbox" formControlName="service_orchestration">
                    <label class="label-control">
                      <span class="checkboxlabel">Service Orchestration</span>
                    </label>
                  </div>
              </div>
              <div class="row col-md-12 m-0 p-0">
                <div class="form-group col-md-6 pl-0">
                  <label class="label-control"> Custom Plan Name<span class="star">*</span></label>
                  <input class="form-control data" placeholder="Enter Custom Plan Name" type="text" value=""
                    formControlName="customPlanName">
                  <span
                    *ngIf="subscriptionForm.get('customPlanName').invalid && subscriptionForm.get('customPlanName').touched && !subscriptionForm.get('customPlanName').hasError('maxlength') && !subscriptionForm.get('customPlanName').hasError('pattern')"
                    class="errspan required"> Custom Plan Name Required* </span>
                  <span
                    *ngIf="subscriptionForm.get('customPlanName').hasError('pattern') && !subscriptionForm.get('customPlanName').hasError('maxlength') && subscriptionForm.get('customPlanName').touched"
                    class="errspan required">Only Alphabets and spaces between words are allowed.</span>
                </div>
                <div class="form-group col-md-6 pl-0">
                  <label class="label-control">Custom Amount<span class="star">*</span></label>
                  <input class="form-control data" placeholder="Enter Custom Amount" type="text" value=""
                    formControlName="customamount">
                  <span
                    *ngIf="subscriptionForm.get('customamount').invalid && subscriptionForm.get('customamount').touched && !subscriptionForm.get('customamount').hasError('maxlength') && !subscriptionForm.get('customamount').hasError('pattern')"
                    class="errspan required"> Custom Amount Required* </span>
                  <span
                    *ngIf="subscriptionForm.get('customamount').hasError('pattern') && !subscriptionForm.get('customamount').hasError('maxlength') && subscriptionForm.get('customamount').touched"
                    class="errspan required">Amount should contain only numbers.</span>
                  <span *ngIf="subscriptionForm.get('customamount').hasError('maxlength')"
                    class="errspan required">Maximum of 6 characters</span>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="row form_footer_content">
        <button class="btn btn-cancel" (click)="closeOverlay()">Cancel</button>
        <button class="btn btn-primary btn-update" (click)="updateCustom()" [disabled]="subscriptionForm.invalid">
          Update
        </button>
      </div>
    </div>
  </div>

  <ngx-spinner bdColor="#bebcbc66" type="">
    <img  src='../../../assets/images/EZFlow_Loader.gif' class="ezflow-loader" alt="EZFlow_Loader"/>
  </ngx-spinner>